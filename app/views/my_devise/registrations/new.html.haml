

= semantic_form_for(resource, :as => resource_name, :url => registration_path(resource_name), :id => 'checkout') do |f|
  = f.semantic_errors
  %input{:type => :hidden, :name => 'package_id', :value => @package_id}/
  .row
    .span10
      #errors
        - if notice
          .alert
            %button.close{:type => "button", 'data-dismiss' => "alert"}
              &times;
            = notice
        - if alert
          .alert.alert-error
            %button.close{:type => "button", 'data-dismiss' => "alert"}
              &times;
            = alert
        - if @errors
          - @errors.each do |error|
            .alert.alert-error
              %button.close{:type => "button", 'data-dismiss' => "alert"}
                &times;
              = error
  .row
    .span5
      %fieldset
        %legend
          Billing Summary
        %label{:for => 'package'} Initial Fee
        .input-prepend.input-append
          .add-on
            .span2.total
              Sub-Total: $
          %input.tally.span1{:value => @subtotal, :name => 'subtotal', :type => "text", :disable => 'disabled' }/
          .add-on .00
        - unless @saved.nil?
          %br
          .input-prepend.input-append
            .add-on
              .span2.total
                Coupon: $
            %input.tally.span1{:value => @saved, :name => 'coupon_total', :type => "text", :disable => 'disabled' }/
            .add-on .00
            .add-on #{@coupon.code}
        %br
        .input-prepend.input-append
          .add-on
            .span2.total.bold
              Total: $
          %input.tally.span1{:value => @total, :name => 'total', :type => "text", :disable => 'disabled' }/
          .add-on.bold .00
        %label{:for => 'subscription'} Monthly Subscription
        .input-prepend.input-append
          .add-on
            .span2.total.bold
              Amount: $
          %input.tally.span1{:value => @amount_total, :name => 'amount_total', :type => "text", :disable => 'disabled' }/
          .add-on .00
    .span5
      %fieldset
        %legend
          Secure Order Form
          %i.icon-lock
        .control-group
          %label{:for => 'name'} Name (as it appears on your card)
          %input{:name => 'name', :placeholder => "Name", :type => "text", :required => 'required', :pattern => '\S+', :id => 'name', :value => @name }/
        .cards
          = image_tag 'mastercard-inactive.gif', :id => 'mastercard'
          = image_tag 'visa-inactive.gif', :id => 'visa'
          = image_tag 'americanexpress-inactive.gif', :id => 'americanexpress'
          = image_tag 'discover-inactive.gif', :id => 'discover'
        %label{:for => 'card_number'} Card number
        %input#card_number{:name => 'card_number', :placeholder => "Card Number", :type => "text", :required => 'required', :value => @card_number}/
        %label{:for => 'expiration_month'} Expiration date
        .input-append
          %select#card_month.span2{:name => 'card_month'}
            - i = 0
            - Date::MONTHNAMES[1..12].each do |name|
              - i += 1
              - val = "%02d" % i
              %option{:value => val}
                #{name} (#{val})
          %select#card_year.span2{:name => 'card_year'}
            - (Time.now.year .. Time.now.year+10).to_a.each do |year|
              %option
                = year
        %label{:for => 'cvv'} Security code (3 on back, Amex: 4 on front)
        %input#cvv.span1{:placeholder => "CVV", :type => "text", :name => 'cvv', :required => 'required', :pattern => '\S+', :value => @cvv }/
        = image_tag 'card_back.png',  :style => 'margin-bottom: 10px'
        = image_tag 'card_front.png',  :style => 'margin-bottom: 10px'
        %span.help-block Enter your card number without spaces or dashes.
  .row
    .span12
      %fieldset
        %legend
          Account Information
        %label{:for => 'user[email]'} Email
        %input{:name => 'user[email]', :placeholder => "Email", :type => "text", :required => 'required', :id => 'email', :value => @email }/
        %span.help-block We won&#39;t spam you or share your address.
        %label{:for => 'user[password]'} Choose a Password
        %input{:name => 'user[password]', :placeholder => "Password", :type => "password", :required => 'required', :id => 'password' }/
        %label{:for => 'user[password_confirmation]'} Verify Password
        %input{:name => 'user[password_confirmation]', :placeholder => "Password Confirmation", :type => "password", :required => 'required', :id => 'password_confirmation' }/
        %br
        %br
        %label.checkbox
          %input#tos{:type => "checkbox", :name => 'tos' }/
          I agree to the
          %a{:href => '/terms'}
            Terms of Service
        %br
        %button.btn.btn-large.btn-info#submit_button{:type => "button"} Place Order
  = render :partial => "devise/shared/links"
